name: Tic tac toe CI/CD 

on:
  workflow_dispatch:
  push:
    paths:
      - .github/workflows/tic-tac-toe.yml
  pull_request:
    paths:
      - .github/workflows/tic-tac-toe.yml.yml
      
env:
  LOGIN: ${{ secrets.DOCKER_LOGIN }}
  PASSWORD: ${{ secrets.DOCKER_PWD }}
  NAME: ${{ secrets.DOCKER_NAME }}
  
jobs:
  test:
    runs-on: [ubuntu-latest]
    name: Running tests
    steps:
    - uses: actions/checkout@master
    - uses: actions/setup-python@v1
      with:
        python-version: '3.10'
    - name: Install requirements
      run: pip install -r requirements.txt
    - name: Run test
      run: |
          python manage.py test
          echo "Tests worked successfully"
  build_publish:
    runs-on: [ubuntu-latest]
    name: Build
    steps:
    - name: Login to docker.io
      run:  echo ${{ secrets.DOCKER_PWD }} | docker login -u ${{ secrets.DOCKER_LOGIN }} --password-stdin
    - uses: actions/checkout@master
    - name: Build image
      run: docker build -t $NAME .
    # - name: Push image
    #   run: |
    #     docker tag $NAME $LOGIN/$NAME:latest
    #     docker push $LOGIN/$NAME:latest
      
        
    
  

      
